<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psion OPK Editor v3.0.1 (Refactored)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles/base.css">
    <link rel="stylesheet" href="styles/layout.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/editor.css">
    <link rel="stylesheet" href="styles/theme.css">
    <link rel="stylesheet" href="styles/psion.css">
    <link rel="stylesheet" href="styles/syntax.css">
</head>

<body>
    <div id="app">
        <!-- Toolbar -->
        <div id="toolbar">
            <button class="tool-btn" id="btn-new-pack" title="New Pack">
                <i class="fas fa-file"></i> New
            </button>
            <button class="tool-btn" id="btn-open-pack" title="Open Pack">
                <i class="fas fa-folder-open"></i> Open
            </button>
            <button class="tool-btn" id="btn-save-pack" title="Save Pack">
                <i class="fas fa-save"></i> Save
            </button>
            <button class="tool-btn" id="btn-export-hex" title="Export Intel HEX">
                <i class="fas fa-file-export"></i> Export Hex
            </button>

            <div class="tool-separator"></div>

            <button class="tool-btn" id="btn-add-item" title="Add New Item">
                <i class="fas fa-plus"></i> Add Item
            </button>
            <button class="tool-btn" id="btn-import-item" title="Import Item">
                <i class="fas fa-file-import"></i> Import Item
            </button>
            <button class="tool-btn" id="btn-delete-item" title="Delete Item">
                <i class="fas fa-trash"></i> Delete
            </button>

            <div class="tool-separator"></div>

            <button class="tool-btn" id="btn-apply" title="Apply Changes">
                <i class="fas fa-check"></i> Apply
            </button>
            <button class="tool-btn" id="btn-discard" title="Discard Changes">
                <i class="fas fa-undo"></i> Discard
            </button>

            <div class="tool-separator"></div>

            <button class="tool-btn" id="btn-options" title="Options">
                <i class="fas fa-cog"></i> Options
            </button>
            <button class="tool-btn" id="btn-about" title="About">
                <i class="fas fa-info-circle"></i> About
            </button>
        </div>

        <!-- Main Content -->
        <div id="main-content">
            <!-- Sidebar -->
            <div id="sidebar">
                <div id="sidebar-header">Pack Contents</div>
                <div id="pack-list">
                    <!-- Items will be populated here -->
                </div>
            </div>

            <!-- Editor Area -->
            <div id="editor-area">
                <div id="editor-header">
                    <span id="current-file-name">No file selected</span>
                </div>
                <div id="editor-container">
                    <!-- Code Editor will be mounted here -->
                    <div id="code-editor-container" style="width: 100%; height: 100%; display: none;"></div>
                    <!-- Legacy Editor for forms/headers -->
                    <div id="legacy-editor" style="display: none;"></div>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <div id="status-bar">
            <div class="status-item" id="status-message">Ready</div>
            <div class="status-item" id="status-checksum"></div>
        </div>

        <!-- Hidden File Inputs -->
        <input type="file" id="file-input-pack" accept=".opk,.hex,.ihx,.bin">
        <input type="file" id="file-input-item" multiple>
    </div>

    <!-- Scripts -->
    <!-- Logic Scripts -->
    <script src="src/logic/binaryfile.js"></script>
    <script src="src/logic/checksums.js"></script>
    <script src="src/logic/intelhex.js"></script>
    <script src="src/logic/packimage.js"></script>

    <!-- State & Services -->
    <script src="src/state/AppState.js"></script>
    <script src="src/services/PackService.js"></script>
    <script src="src/services/FileService.js"></script>

    <!-- UI Components -->
    <script src="src/ui/components/dragdroplist.js"></script>
    <script src="src/ui/components/selectlist.js"></script>
    <script src="src/ui/components/modal.js"></script>
    <script src="src/ui/components/syntaxhighlighter.js"></script>
    <script src="src/ui/editors/RecordEditor.js"></script>

    <script src="src/ui/managers/optionsmanager.js"></script>
    <script src="src/ui/managers/thememanager.js"></script>
    <script src="src/ui/managers/tooltipmanager.js"></script>

    <!-- Controller -->
    <script src="src/ui/controllers/opkedit.js"></script>

    <script>
        // Initialize App
        // Controller will handle initialization
    </script>
</body>

</html>